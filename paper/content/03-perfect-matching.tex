\chapter{Perfect matching}

\section{Tutte Matrix}

\begin{definition}[Indeterminates]

\end{definition}

\begin{definition}[Tutte Matrix]
    Given a graph \(G\) and a function that maps \(f\) every edge of \(G\) to an indeterminate.
    Then, a tutte matrix is a matrix such that, for each \(uv \in E(G)\), one has \(T_{uv} = -T_{vu} = f(vu)\).
\end{definition}

\begin{fact}[Tutte matrix perfect matching condition]
    \label{fact:matching_condition}
    A graph \(G\) has a perfect matching iff \(T_G\) is non-singular.
\end{fact}

\begin{proof}
    This is direct from Pffafian.
\end{proof}

\subsection{Probabilistic representation of a Tutte Matrix}

\section{Basic\footnote{Rename} algorithm}

Using fact \ref{fact:matching_condition}, the following algorithm finds a perfect matching in \(O(n^{\omega+2})\).
We iterate through each edge from \(G\) and 
an edge \(e\) is removed if the resulting graph \(G' \coloneqq (V_G, E_G - \{e\})\) still has a perfect matching, indicating that \(e\) is not essential.
Otherwise, \(e\) belongs to a perfect matching of \(G\).

\section{Rank-2 update algorithm}

The bottleneck of the previous algorithm is the necessity to recompute the whole matrix inverse after each iteration.
By using the following corollary, a more efficient \(O(n^4)\) algorithm is achieved.

\begin{corollary}[Condition for edge removal\footnote{Maybe rename this.}]
    \label{cor:condition_edge_removal}
    Let \(G\) be a graph, \(T\) be a Tutte matrix of \(G\) and \(N \coloneqq T^{-1}\)
    An edge \(ij\) is essential if and only if \(N_{ij} = -1/T_{ij}\).
\end{corollary}

\begin{proof}
    TODO(amsah): equation (3.6) shows this necessity.
\end{proof}

We use Corollary \ref{cor:condition_edge_removal} to quickly decide if an edge is essential. 
If it's not, we remove it and update the matrix using a rank-2 update. 
This removes the necessity to recompute the whole inverse in each iteration.
Since there are at most \(n^2\) edges and each update takes \(O(n^2)\) time, the total time complexity is \(O(n^4)\).
